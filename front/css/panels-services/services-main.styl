// Transform break position static
// Problematic in mobile responsive design
.hw-services
  position relative
  z-index 1
  transform translateZ(0)  // Why this transform?

.hw-services-list
  perspective 1000px
  perspective-origin center center
  height px2em($panel-height)
  -webkit-font-smoothing antialiased
  clearfix()

  h3:first-child
    margin-top 0

  .hw-sub-left,
  .hw-sub-right
    background $darkest-grey

.hw-services-item
  position relative
  float left
  width third()
  height 100%
  transform-style preserve-3d
  top 0
  z-index 1
  margin-bottom 0

  .hicon
    font-size 6em
    // Transform doesn't work on inline display
    display inline-block
    color $pink
    iso-right()

  &:not(:target):not(.{activeClass})
    .hw-services-cover
      cursor pointer

      &:hover
        box-shadow inset 0 0 0 px2em($hover-width) $hover-color

  &:nth-child(3n+1),
  &:nth-child(3n+3)
    .hw-services-cover
      iso-left()

  &:nth-child(3n+2)
    .hw-services-cover
      background $grey
      iso-right()

    .hicon
      iso-left()

  &:nth-child(3n+2),
  &:nth-child(3n+3)
    .hw-sub-left
      left -100% // Reposition panel for scroll issues on firefox
      // 1% difference is for nice edge aliasis
      transform-origin 101% 50%

  &:nth-child(3n+1),
  &:nth-child(3n+2)
    .hw-sub-right
      left 100% // Reposition panel for scroll issues on firefox
      // 1% difference is for nice edge aliasis
      transform-origin -1% 50%

.hw-sub
  overflow hidden
  height 100%; width @height
  box-sizing border-box
  absolute top left
  z-index 1
  backface-visibility hidden

.hw-services-cover
  z-index 3
  color $black
  background white
  box-sizing border-box
  padding 3em 0 0
  text-align center
  transition  box-shadow $hover-transition ease 0s
  v-align()

  h6
    font-size 1.75em; text-transform uppercase
    letter-spacing .125em
    font-weight normal
    margin 0 0 0

  .no-js & a
    absolute top left
    right 0; bottom 0
    text-indent 100%
    white-space nowrap
    overflow hidden

  .js & a
    display none


.hw-sub-description
  color white

.hw-sub-close
.hw-sub-description
  hide()

.hw-sub-panel
  height 100%; width @height
  box-sizing border-box
  padding $panel-padding $panel-padding 0
  font-size px2em($panel-fs)
  line-height 1.5em
  // transform translate3d(0,0,0) // Why this transform ?

.hw-sub-description

  p
    margin-bottom 0

  ul, li
    list-style none
    reset-box-model()

  li
    padding-left 1em
    position relative

  li::before
    content '\25A0'
    color $dark-grey
    absolute left

// Close button
.hw-sub-close
  width 2em; height @width
  absolute top -25% left 100%; z-index 5
  text-align center; line-height 1.5em
  background $dark-gray; box-shadow 2px 2px 0 noir(.75)
  cursor pointer
  margin-left -2.5em
  margin-top .5em

  &::after
    color $blue
    font-size 2em
    content 'Ã—'
    font-weight bold

  &:hover
    background $gray

    &::after
      color $blue

  &:active
    transform translate(2px, 2px)
    box-shadow none

  .js & a
    display none

  .no-js & a
    absolute top left
    right 0; bottom 0
    text-indent 100%
    white-space nowrap
    overflow hidden

/////////////
// Activate Panel
/////////////

.hw-services-item.{activeClass},
.hw-services-item:target
  z-index 10

  .hw-services-cover
    color $grey
    background $dark-grey

  .hicon
    iso-reset()
    font-size 12em
    color $darkest-grey

  .hw-sub
    iso-reset()
    height 150%
    top  -25%

  .hw-sub-close,
  .hw-sub
    show()

// active positioning
for num in 1 2 3
  .hw-services-item.{activeClass}:nth-child(3n+{num}),
  .hw-services-item:target:nth-child(3n+{num})
    .hw-sub-left
      left unit((1 - num) * 100, '%')

    .hw-services-cover
      left unit((2 - num) * 100, '%')

    .hw-sub-right
      left unit((3 - num) * 100, '%')

    .hw-sub-close
      left unit((4 - num) * 100, '%')
